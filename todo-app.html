<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“‹ í•  ì¼ ê´€ë¦¬ ì•±</title>
    <style>
        /* ğŸ¯ CSSëŠ” ìµœì†Œí•œìœ¼ë¡œ! ê¸°ëŠ¥ì— ì§‘ì¤‘ */
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
        }
        
        /* ğŸ¯ ëª¨ë“  ë²„íŠ¼ ë™ì¼í•œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        .btn-danger { background: #dc3545; }
        .btn-danger:hover { background: #c82333; }
        
        .btn-success { background: #28a745; }
        .btn-success:hover { background: #218838; }
        
        .btn-warning { background: #ffc107; color: #212529; }
        .btn-warning:hover { background: #e0a800; }
        
        /* ì…ë ¥ í•„ë“œë“¤ */
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 5px 0;
            font-size: 16px;
        }
        
        /* í•  ì¼ ì•„ì´í…œ */
        .todo-item {
            padding: 15px;
            margin: 10px 0;
            border: 1px solid #eee;
            border-radius: 5px;
            background: white;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .todo-item.completed {
            background: #f8f9fa;
            opacity: 0.7;
        }
        
        .todo-text {
            flex: 1;
            font-size: 16px;
        }
        
        .todo-text.completed {
            text-decoration: line-through;
            color: #6c757d;
        }
        
        .priority {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .priority-high { background: #ffebee; color: #c62828; }
        .priority-medium { background: #fff3e0; color: #ef6c00; }
        .priority-low { background: #e8f5e8; color: #2e7d32; }
        
        /* í•„í„° ì„¹ì…˜ */
        .filters {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 5px;
            margin: 20px 0;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .stats {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            text-align: center;
        }
        
        /* ë°˜ì‘í˜• */
        @media (max-width: 600px) {
            .filters {
                flex-direction: column;
                align-items: stretch;
            }
            
            .todo-item {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“‹ í•  ì¼ ê´€ë¦¬ ì•±</h1>
            <p>JavaScript ì¤‘ì‹¬ í•™ìŠµ í”„ë¡œì íŠ¸</p>
        </div>

        <!-- í•  ì¼ ì¶”ê°€ ì„¹ì…˜ -->
        <div class="add-section">
            <h3>ğŸ†• ìƒˆ í•  ì¼ ì¶”ê°€</h3>
            <input type="text" id="todoInput" class="form-control" placeholder="í•  ì¼ì„ ì…ë ¥í•˜ì„¸ìš”..." maxlength="100">
            <div style="margin: 10px 0;">
                <label>ìš°ì„ ìˆœìœ„:</label>
                <select id="prioritySelect" class="form-control" style="width: auto; display: inline-block; margin-left: 10px;">
                    <option value="low">ë‚®ìŒ</option>
                    <option value="medium">ë³´í†µ</option>
                    <option value="high">ë†’ìŒ</option>
                </select>
                <label>ì¹´í…Œê³ ë¦¬:</label>
                <select id="categorySelect" class="form-control" style="width: auto; display: inline-block; margin-left: 10px;">
                    <option value=0>ê°œì¸ğŸ‘¤</option>
                    <option value=1>ì—…ë¬´ğŸ’¼</option>
                    <option value=2>í•™ìŠµğŸ“š</option>
                    <option value=3>ê±´ê°•ğŸ’ª</option>
                </select>
                <label>ğŸ—“ï¸ ë§ˆê°ì¼ ì„¤ì •:</label>
                <input type="date" id="dueDateInput">
            </div>
            
            <button class="btn btn-success" onclick="addTodo()">â• ì¶”ê°€í•˜ê¸°</button>
        </div>

        <!-- í•„í„° ë° ê²€ìƒ‰ ì„¹ì…˜ -->
        <div class="filters">
            <div>
                <label>í•„í„°:</label>
                <button class="btn filter-btn active" onclick="filterTodos('all')" data-filter="all">ì „ì²´</button>
                <button class="btn filter-btn" onclick="filterTodos('active')" data-filter="active">ì§„í–‰ì¤‘</button>
                <button class="btn filter-btn" onclick="filterTodos('completed')" data-filter="completed">ì™„ë£Œë¨</button>
            </div>
            
            <div>
                <label>ìš°ì„ ìˆœìœ„:</label>
                <button class="btn filter-btn" onclick="filterByPriority('all')" data-priority="all">ì „ì²´</button>
                <button class="btn btn-danger filter-btn" onclick="filterByPriority('high')" data-priority="high">ë†’ìŒ</button>
                <button class="btn btn-warning filter-btn" onclick="filterByPriority('medium')" data-priority="medium">ë³´í†µ</button>
                <button class="btn btn-success filter-btn" onclick="filterByPriority('low')" data-priority="low">ë‚®ìŒ</button>
            </div>
            
            <div>
                <label>ì¹´í…Œê³ ë¦¬:</label>
                <button class="btn filter-btn" onclick="filterByCategory(0)">ê°œì¸ğŸ‘¤</button>
                <button class="btn btn-danger filter-btn" onclick="filterByCategory(1)">ì—…ë¬´ğŸ’¼</button>
                <button class="btn btn-warning filter-btn" onclick="filterByCategory(2)">í•™ìŠµğŸ“š</button>
                <button class="btn btn-success filter-btn" onclick="filterByCategory(3)">ê±´ê°•ğŸ’ª</button>
            </div>
        
            <div style="flex: 1;">
                <input type="text" id="searchInput" class="form-control" placeholder="í•  ì¼ ê²€ìƒ‰..." onkeyup="searchTodos()">
            </div>
        </div>

        <!-- í†µê³„ ì„¹ì…˜ -->
        <div class="stats" id="statsSection">
            <strong>í†µê³„:</strong> 
            <span id="totalCount">0</span>ê°œ ì „ì²´ | 
            <span id="activeCount">0</span>ê°œ ì§„í–‰ì¤‘ | 
            <span id="completedCount">0</span>ê°œ ì™„ë£Œ |
            <span id="completionRate">0%</span> ì™„ë£Œ
        </div>

        <!-- í•  ì¼ ëª©ë¡ -->
        <div class="todo-list" id="todoList">
            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
        </div>

        <!-- ì „ì²´ ì‚­ì œ ë²„íŠ¼ -->
        <div style="text-align: center; margin-top: 30px;">
            <button class="btn btn-danger" onclick="clearAllTodos()">ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ</button>
            <button class="btn btn-warning" onclick="clearCompletedTodos()">âœ… ì™„ë£Œëœ í•­ëª© ì‚­ì œ</button>
        </div>
    </div>

    <script>
        // ğŸ¯ ì „ì—­ ë³€ìˆ˜ë“¤ - ì•±ì˜ ìƒíƒœ ê´€ë¦¬
        let todos = [];
        let currentFilter = 'all';
        let currentPriorityFilter = 'all';
        let currentSearchTerm = '';
        let currentCategoryFilter = '';
        const categories = ['ê°œì¸', 'ì—…ë¬´', 'í•™ìŠµ', 'ê±´ê°•'];
        const categoryColors = {
            'ê°œì¸': '#6f42c1',    // ë³´ë¼ìƒ‰
            'ì—…ë¬´': '#dc3545',    // ë¹¨ê°„ìƒ‰  
            'í•™ìŠµ': '#0d6efd',    // íŒŒë€ìƒ‰
            'ê±´ê°•': '#198754'     // ì´ˆë¡ìƒ‰
        };
        const categoryIcons = {
            'ê°œì¸': 'ğŸ‘¤',
            'ì—…ë¬´': 'ğŸ’¼', 
            'í•™ìŠµ': 'ğŸ“š',
            'ê±´ê°•': 'ğŸ’ª'
        };

        // ğŸ¯ í• ì¼ì— ë©”ì„œë“œ ì¶”ê°€í•˜ëŠ” í—¬í¼ í•¨ìˆ˜ (ì¤‘ìš”!)
        function addMethodsToTodo(todo) {
            if (!todo.category) todo.category = 'ê°œì¸'; // ê¸°ë³¸ê°’
            
            todo.isOverdue = function() {
                return this.dueDate && new Date(this.dueDate) < new Date() && !this.completed; 
            };
            
            todo.getCategoryStyle = function() {
                return {
                    color: categoryColors[this.category] || '#000',
                    icon: categoryIcons[this.category] || 'ğŸ“'
                };
            };
            
            return todo;
        }

        // ğŸ¯ í•  ì¼ ê°ì²´ êµ¬ì¡°
        /*
        {
            id: ê³ ìœ ë²ˆí˜¸,
            text: "í•  ì¼ ë‚´ìš©",
            completed: true/false,
            priority: "high/medium/low",
            createdAt: "ìƒì„±ì‹œê°„",
            completedAt: "ì™„ë£Œì‹œê°„"
        }
        */

        // ğŸ¯ í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“‹ í•  ì¼ ì•± ì‹œì‘!');
            loadTodosFromStorage();
            renderTodos();
            setupEventListeners();
            
            // ê°œë°œìë¥¼ ìœ„í•œ ìƒ˜í”Œ ë°ì´í„° (ì²˜ìŒ ì‹¤í–‰ ì‹œ)
            if (todos.length === 0) {
                addSampleData();
            }
        });

        // ğŸ¯ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupEventListeners() {
            const todoInput = document.getElementById('todoInput');
            
            // Enter í‚¤ë¡œ í•  ì¼ ì¶”ê°€
            todoInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addTodo();
                }
            });

            // ì‹¤ì‹œê°„ ê²€ìƒ‰
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', function() {
                searchTodos();
            });
        }

        // ğŸ¯ ìƒˆ í•  ì¼ ì¶”ê°€
        function addTodo() {
            if (todos.length >= 10) {
                alert("í•  ì¼ì€ ìµœëŒ€ 10ê°œê¹Œì§€ë§Œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!");
                return;
            } 
            const input = document.getElementById('todoInput');
            const prioritySelect = document.getElementById('prioritySelect');
            const text = input.value.trim();
            
            // ì…ë ¥ ê²€ì¦
            if (text === '') {
                alert('í•  ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                input.focus();
                return;
            }

            if (text.length > 100) {
                alert('í•  ì¼ì€ 100ì ì´ë‚´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            // ìƒˆ í•  ì¼ ê°ì²´ ìƒì„±
            const newTodo = {
                id: Date.now(),// ê°„ë‹¨í•œ ê³ ìœ  ID
                text,
                completed: false,
                priority: prioritySelect.value,
                createdAt: new Date().toLocaleString('ko-KR'),
                completedAt: null,
                dueDate: document.getElementById('dueDateInput').value,
                category: categories[parseInt(document.getElementById('categorySelect').value)], 
                
            };

            // ë©”ì„œë“œ ì¶”ê°€
            addMethodsToTodo(newTodo);

            // ë°°ì—´ì— ì¶”ê°€ (ìµœì‹  í•­ëª©ì„ ë§¨ ìœ„ì—)
            todos.unshift(newTodo);
            
            // UI ì—…ë°ì´íŠ¸
            input.value = '';
            prioritySelect.value = 'low';
            document.getElementById('dueDateInput').value = '';
            document.getElementById('categorySelect').value = '0';
            input.focus();
            
            // ì €ì¥ ë° ë Œë”ë§
            saveTodosToStorage();
            renderTodos();
            
            console.log('âœ… ìƒˆ í•  ì¼ ì¶”ê°€:', newTodo);
        }

        // ğŸ¯ í•  ì¼ ì™„ë£Œ/ë¯¸ì™„ë£Œ í† ê¸€
        function toggleTodo(id) {
            const todo = todos.find(t => t.id === id);
            if (!todo) return;

            todo.completed = !todo.completed;
            todo.completedAt = todo.completed ? new Date().toLocaleString('ko-KR') : null;
            
            saveTodosToStorage();
            renderTodos();
            
            console.log(todo.completed ? 'âœ… ì™„ë£Œ:' : 'ğŸ”„ ë¯¸ì™„ë£Œ:', todo.text);
        }

        // ğŸ¯ í•  ì¼ ì‚­ì œ
        function deleteTodo(id) {
            const todo = todos.find(t => t.id === id);
            if (!todo) return;

            if (confirm(`"${todo.text}"ì„(ë¥¼) ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                todos = todos.filter(t => t.id !== id)
                saveTodosToStorage();
                renderTodos();
                console.log('ğŸ—‘ï¸ ì‚­ì œ:', todo.text);
            }
        }

        // ğŸ¯ í•  ì¼ ìˆ˜ì •
        function editTodo(id) {
            const todo = todos.find(t => t.id === id);
            if (!todo) return;

            const newText = prompt('í•  ì¼ì„ ìˆ˜ì •í•˜ì„¸ìš”:', todo.text);
            if (newText === null) return; // ì·¨ì†Œ
            
            const trimmedText = newText.trim();
            if (trimmedText === '') {
                alert('í•  ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            if (trimmedText.length > 100) {
                alert('í•  ì¼ì€ 100ì ì´ë‚´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            todo.text = trimmedText;
            saveTodosToStorage();
            renderTodos();
            
            console.log('âœï¸ ìˆ˜ì •:', todo.text);
        }

        // ğŸ¯ ìš°ì„ ìˆœìœ„ ë³€ê²½
        function changePriority(id) {
            const todo = todos.find(t => t.id === id);
            if (!todo) return;

            const priorities = ['low', 'medium', 'high'];
            const currentIndex = priorities.indexOf(todo.priority);
            const nextIndex = (currentIndex + 1) % priorities.length;
            
            todo.priority = priorities[nextIndex];
            saveTodosToStorage();
            renderTodos();
            
            console.log('ğŸ¯ ìš°ì„ ìˆœìœ„ ë³€ê²½:', todo.text, '->', todo.priority);
        }

        // ğŸ¯ í•„í„°ë§ í•¨ìˆ˜ë“¤
        function filterTodos(filter) {
            currentFilter = filter;
            updateActiveFilterButton();
            renderTodos();
            console.log('ğŸ” í•„í„° ë³€ê²½:', filter);
        }

        function filterByPriority(priority) {
            currentPriorityFilter = priority;
            renderTodos();
            console.log('ğŸ¯ ìš°ì„ ìˆœìœ„ í•„í„°:', priority);
        }

        function filterByCategory(idx) {
            if (!currentCategoryFilter || (currentCategoryFilter !== categories[idx])) {
                currentCategoryFilter = categories[idx];
            } else {
                currentCategoryFilter = '';
            }
            renderTodos();
            console.log('ì¹´í…Œê³ ë¦¬ í•„í„°:', categories[idx]);
        }

        function searchTodos() {
            const searchInput = document.getElementById('searchInput');
            currentSearchTerm = searchInput.value.trim().toLowerCase();
            renderTodos();
            console.log('ğŸ” ê²€ìƒ‰ì–´:', currentSearchTerm);
        }

        // ğŸ¯ í•„í„° ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateActiveFilterButton() {
            const filterButtons = document.querySelectorAll('.filter-btn[data-filter]');
            filterButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.filter === currentFilter) {
                    btn.classList.add('active');
                    btn.style.background = '#0056b3';
                } else {
                    btn.style.background = '';
                }
            });
        }

        // ğŸ¯ í•  ì¼ ëª©ë¡ ë Œë”ë§ (í•µì‹¬ í•¨ìˆ˜!)
        function renderTodos() {
            const todoList = document.getElementById('todoList');
            
            // 1ë‹¨ê³„: í•„í„°ë§ëœ í•  ì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
            let filteredTodos = getFilteredTodos();
            
            // 2ë‹¨ê³„: ë¹ˆ ëª©ë¡ ì²˜ë¦¬
            if (filteredTodos.length === 0) {
                todoList.innerHTML = `
                    <div style="text-align: center; padding: 50px; color: #6c757d;">
                        <h3>ğŸ“­ í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p>ìƒˆë¡œìš´ í•  ì¼ì„ ì¶”ê°€í•´ë³´ì„¸ìš”!</p>
                    </div>
                `;
                updateStats();
                return;
            }

            // 3ë‹¨ê³„: ìš°ì„ ìˆœìœ„ë³„ ì •ë ¬
            filteredTodos.sort((a, b) => {
                const priorityOrder = { high: 3, medium: 2, low: 1 };
                if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
                    return priorityOrder[b.priority] - priorityOrder[a.priority];
                }
                // ê°™ì€ ìš°ì„ ìˆœìœ„ë©´ ìµœì‹ ìˆœ
                return new Date(b.createdAt) - new Date(a.createdAt);
            });

            // 4ë‹¨ê³„: HTML ìƒì„±
            const todosHTML = filteredTodos.map(todo => createTodoHTML(todo)).join('');
            todoList.innerHTML = todosHTML;

            // 5ë‹¨ê³„: í†µê³„ ì—…ë°ì´íŠ¸
            updateStats();
            
            console.log('ğŸ–¼ï¸ ë Œë”ë§ ì™„ë£Œ:', filteredTodos.length, 'ê°œ í•­ëª©');
        }

        // ğŸ¯ í•„í„°ë§ëœ í•  ì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        function getFilteredTodos() {
            return todos.filter(todo => {
                // ì™„ë£Œ ìƒíƒœ í•„í„°
                if (currentFilter === 'active' && todo.completed) return false;
                if (currentFilter === 'completed' && !todo.completed) return false;
                
                // ìš°ì„ ìˆœìœ„ í•„í„°
                if (currentPriorityFilter !== 'all' && todo.priority !== currentPriorityFilter) return false;
                
                // ì¹´í…Œê³ ë¦¬ í•„í„°
                if (currentCategoryFilter !== '' && todo.category !== currentCategoryFilter) return false;

                // ê²€ìƒ‰ì–´ í•„í„°
                if (currentSearchTerm && !todo.text.toLowerCase().includes(currentSearchTerm)) return false;
                
                return true;
            });
        }

        // ğŸ¯ ê°œë³„ í•  ì¼ HTML ìƒì„±
        function createTodoHTML(todo) {
            const priorityClass = `priority priority-${todo.priority}`;
            const priorityText = { high: 'ë†’ìŒ', medium: 'ë³´í†µ', low: 'ë‚®ìŒ' }[todo.priority];
            
            // ì•ˆì „í•˜ê²Œ ì¹´í…Œê³ ë¦¬ ìŠ¤íƒ€ì¼ ê°€ì ¸ì˜¤ê¸°
            let categoryStyle = { color: '#000', icon: 'ğŸ“' };
            if (todo.getCategoryStyle && typeof todo.getCategoryStyle === 'function') {
                categoryStyle = todo.getCategoryStyle();
            } else if (todo.category) {
                categoryStyle = {
                    color: categoryColors[todo.category] || '#000',
                    icon: categoryIcons[todo.category] || 'ğŸ“'
                };
            }
            
            // ë§ˆê°ì¼ í‘œì‹œ
            let dueDateDisplay = '';
            if (todo.dueDate) {
                if (todo.isOverdue && typeof todo.isOverdue === 'function' && todo.isOverdue()) {
                    dueDateDisplay = `<div style="font-size: 12px; color: #dc3545;">ğŸš¨ ë§ˆê°ì¼ ì§€ë‚¨: ${todo.dueDate}</div>`;
                } else {
                    dueDateDisplay = `<div style="font-size: 12px; color: #6c757d;">ğŸ“… ë§ˆê°ì¼: ${todo.dueDate}</div>`;
                }
            }



            return `
                <div class="todo-item ${todo.completed ? 'completed' : ''}">
                    <input type="checkbox" 
                           ${todo.completed ? 'checked' : ''} 
                           onchange="toggleTodo(${todo.id})"
                           style="transform: scale(1.2);">
                    
                    <span class="todo-text ${todo.completed ? 'completed' : ''}">${escapeHtml(todo.text)}</span>
                    
                    <span class="${priorityClass}">${priorityText}</span>
                     <span style="color: ${categoryStyle.color}">${categoryStyle.icon} ${todo.category}</span>
                    <div>
                        <button class="btn" onclick="editTodo(${todo.id})" title="ìˆ˜ì •">âœï¸</button>
                        <button class="btn btn-warning" onclick="changePriority(${todo.id})" title="ìš°ì„ ìˆœìœ„ ë³€ê²½">ğŸ¯</button>
                        <button class="btn btn-danger" onclick="deleteTodo(${todo.id})" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                    </div>
                    
                    <div style="font-size: 12px; color: #6c757d;">
                        ìƒì„±: ${todo.createdAt}
                        ${todo.completedAt ? `<br>ì™„ë£Œ: ${todo.completedAt}` : ''}
                    </div>
                    <div style="font-size: 12px; color: #dc3545;">
                    ${!todo.completed && !todo.isOverdue ? `ë§ˆê°ì¼: ${todo.dueDate}` : 'ë§ˆê°ì¼ ì§€ë‚¨'}
                    </div>
                </div>
            `;
        }

        // ğŸ¯ í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            const total = todos.length;
            const completed = todos.filter(t => t.completed).length;
            const active = total - completed;
            const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;

            document.getElementById('totalCount').textContent = total;
            document.getElementById('activeCount').textContent = active;
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('completionRate').textContent = `${percentage}%`;
        }

        // ğŸ¯ ì „ì²´ ì‚­ì œ
        function clearAllTodos() {
            if (todos.length === 0) {
                alert('ì‚­ì œí•  í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            if (confirm(`ëª¨ë“  í•  ì¼ ${todos.length}ê°œë¥¼ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                todos = [];
                saveTodosToStorage();
                renderTodos();
                console.log('ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ ì™„ë£Œ');
            }
        }

        // ğŸ¯ ì™„ë£Œëœ í•­ëª©ë§Œ ì‚­ì œ
        function clearCompletedTodos() {
            const completedTodos = todos.filter(t => t.completed);
            
            if (completedTodos.length === 0) {
                alert('ì™„ë£Œëœ í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            if (confirm(`ì™„ë£Œëœ í•  ì¼ ${completedTodos.length}ê°œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                todos = todos.filter(t => !t.completed);
                saveTodosToStorage();
                renderTodos();
                console.log('âœ… ì™„ë£Œëœ í•­ëª© ì‚­ì œ:', completedTodos.length, 'ê°œ');
            }
        }

        // ğŸ¯ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ì €ì¥
        function saveTodosToStorage() {
            try {
                // í•¨ìˆ˜ë“¤ì„ ì œê±°í•œ ìˆœìˆ˜ ë°ì´í„°ë§Œ ì €ì¥
                const dataToSave = todos.map(todo => ({
                    id: todo.id,
                    text: todo.text,
                    completed: todo.completed,
                    priority: todo.priority,
                    createdAt: todo.createdAt,
                    completedAt: todo.completedAt,
                    dueDate: todo.dueDate,
                    category: todo.category
                }));
                localStorage.setItem('todos', JSON.stringify(todos));
                console.log('ğŸ’¾ ì €ì¥ ì™„ë£Œ:', todos.length, 'ê°œ í•­ëª©');
            } catch (error) {
                console.error('ğŸ’¥ ì €ì¥ ì‹¤íŒ¨:', error);
                alert('ë°ì´í„° ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ğŸ¯ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadTodosFromStorage() {
            try {
                const stored = localStorage.getItem('todos');
                if (stored) {
                    const loadedTodos = JSON.parse(stored);
                    // ë¶ˆëŸ¬ì˜¨ ê° í• ì¼ì— ë©”ì„œë“œ ì¶”ê°€
                    todos = loadedTodos.map(todo => addMethodsToTodo(todo));
                    console.log('ğŸ“‚ ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ:', todos.length, 'ê°œ í•­ëª©');
                } else {
                    console.log('ğŸ“‚ ì €ì¥ëœ ë°ì´í„° ì—†ìŒ');
                }
            } catch (error) {
                console.error('ğŸ’¥ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', error);
                todos = [];
            }
        }

        // ğŸ¯ ìƒ˜í”Œ ë°ì´í„° ì¶”ê°€ (ì²« ì‹¤í–‰ ì‹œ)
        function addSampleData() {
            const sampleTodos = [
                { text: 'JavaScript ê¸°ë³¸ê¸° ë³µìŠµí•˜ê¸°', priority: 'high', category: 'í•™ìŠµ' },
                { text: 'React ê°•ì˜ ë“£ê¸°', priority: 'medium', category: 'í•™ìŠµ' },
                { text: 'ìš´ë™í•˜ê¸°', priority: 'low', category: 'ê±´ê°•' },
                { text: 'í”„ë¡œì íŠ¸ íšŒì˜', priority: 'high', category: 'ì—…ë¬´' }
            ];
            sampleTodos.forEach(sample => {
                const todo = {
                    id: Date.now() + Math.random(), // ê³ ìœ  ID
                    text: sample.text,
                    completed: false,
                    priority: sample.priority,
                    createdAt: new Date().toLocaleString('ko-KR'),
                    completedAt: null,
                    dueDate: '',
                    category: sample.category
                };

                // ë©”ì„œë“œ ì¶”ê°€
                addMethodsToTodo(todo);
                todos.push(todo);
            });

            // í•˜ë‚˜ëŠ” ì™„ë£Œ ìƒíƒœë¡œ
            if (todos.length > 0) {
                todos[todos.length - 1].completed = true;
                todos[todos.length - 1].completedAt = new Date().toLocaleString('ko-KR');
            }

            saveTodosToStorage();
            console.log('ğŸ¯ ìƒ˜í”Œ ë°ì´í„° ì¶”ê°€ ì™„ë£Œ');
        }

        // ğŸ¯ HTML ì´ìŠ¤ì¼€ì´í”„ (ë³´ì•ˆ)
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }

        // ğŸ¯ ê°œë°œì ë„êµ¬ í•¨ìˆ˜ë“¤ (ì½˜ì†”ì—ì„œ í…ŒìŠ¤íŠ¸ìš©)
        window.debugTodos = {
            showAll: () => console.table(todos),
            addRandom: () => {
                const randomTexts = ['ì»¤í”¼ ë§ˆì‹œê¸°', 'ì‚°ì±…í•˜ê¸°', 'ìŒì•… ë“£ê¸°', 'ì˜í™” ë³´ê¸°'];
                const randomText = randomTexts[Math.floor(Math.random() * randomTexts.length)];
                document.getElementById('todoInput').value = randomText;
                addTodo();
            },
            clearStorage: () => {
                localStorage.removeItem('todos');
                location.reload();
            }
        };

        console.log('ğŸ”§ ê°œë°œì ë„êµ¬ ì‚¬ìš©ë²•:');
        console.log('debugTodos.showAll() - ëª¨ë“  í•  ì¼ í…Œì´ë¸”ë¡œ ë³´ê¸°');
        console.log('debugTodos.addRandom() - ëœë¤ í•  ì¼ ì¶”ê°€');
        console.log('debugTodos.clearStorage() - ì €ì¥ì†Œ ì´ˆê¸°í™”');
    </script>
</body>
</html>